import requests

# Replace 'YOUR_API_KEY' with your actual VirusTotal API key
API_KEY = '57cf68ce6f4432ad1ed5472383f6d68becca333d66bbb247ad5068241ae4473a'

def query_virustotal(url):
    api_url = f'https://www.virustotal.com/api/v3/urls/{url}'
    headers = {'x-apikey': API_KEY}
    response = requests.get(api_url, headers=headers)
    return response.json()

def read_url_list(file_path):
    with open(file_path, 'r') as file:
        return [line.strip() for line in file]
   
def main():
    url_list = read_url_list('C:\\Users\\Administrator\\Desktop\\urls.txt')  # Replace with your file path
    results = {}
    malicious_urls = []  # List to store URLs with malicious activity

    for url in url_list:
        print(f'Querying {url}...')
        result = query_virustotal(url)
        results[url] = result

        # Check if 'malicious' field is greater than zero
        malicious_count = result.get('data', {}).get('attributes', {}).get('last_analysis_stats', {}).get('malicious', 0)
        if malicious_count > 0:
            malicious_urls.append(url)  # Add the URL to the malicious_urls list

    # Print the URLs with malicious activity
    print("URLs with malicious activity:")
    for url in malicious_urls:
        print(url)

if __name__ == '__main__':
    main()
