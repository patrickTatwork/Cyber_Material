import requests

# Replace 'YOUR_API_KEY' with your actual VirusTotal API key
API_KEY = ''

def query_virustotal(hash):
    url = f'https://www.virustotal.com/api/v3/files/{hash}'
    headers = {'x-apikey': API_KEY}
    response = requests.get(url, headers=headers)
    return response.json()

def read_hash_list(file_path):
    with open(file_path, 'r') as file:
        return [line.strip() for line in file]
   
def main():
    hash_list = read_hash_list('C:\\Users\\Administrator\\Desktop\\hashes.txt')  # Replace with your file path
    results = {}
    malicious_hashes = []  # List to store hashes with malicious activity

    for hash in hash_list:
        print(f'Querying {hash}...')
        result = query_virustotal(hash)
        results[hash] = result

        # Check if 'malicious' field is greater than zero
        malicious_count = result.get('data', {}).get('attributes', {}).get('last_analysis_stats', {}).get('malicious', 0)
        if malicious_count > 0:
            malicious_hashes.append(hash)  # Add the hash to the malicious_hashes list

    # Print the hashes with malicious activity
    print("Hashes with malicious activity:")
    for hash in malicious_hashes:
        print(hash)

if __name__ == '__main__':
    main()